<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Viewer</title>

<style>
    body {
        font-family: Arial, sans-serif;
        padding: 0;
        margin: 0;
        background: #0f172a; /* nền đậm kiểu sân đấu */
        color: #111827;
    }

    #container {
        padding: 10px;
        max-width: 1200px;
        margin: auto;
    }

    /* Thẻ “card” bao quanh bảng cho chuyên nghiệp */
    .sheet-card {
        background: #ffffff;
        border-radius: 10px;
        box-shadow: 0 12px 30px rgba(15, 23, 42, 0.35);
        padding: 14px 14px 18px;
        margin-top: 16px;
        border: 1px solid #1f2937;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        background: white;
        margin-top: 8px;
    }

    /* Header bảng */
    tr.header-row th {
        background: #0b2540;      /* navy */
        color: #ffffff;
        font-weight: 700;
        padding: 8px 8px;
        text-transform: uppercase;
        font-size: 12px;
        letter-spacing: 0.04em;
        border-bottom: 2px solid #111827;
    }

    /* Ô dữ liệu chung */
    td {
        padding: 6px 8px;
        border: none;
        font-size: 13px;
    }

    /* Zebra cho data-row */
    tr.data-row.data-odd td {
        background: #ffffff;
    }

    tr.data-row.data-even td {
        background: #f3f4f6;
    }

    /* Hover hiệu ứng bóng bàn đấu */
    tr.data-row:hover td {
        background: #e0f2fe;
    }

    /* Cột STT: hẹp, nổi bật */
    tr.header-row th:nth-child(1),
    tr.data-row td:nth-child(1) {
        width: 40px;
        text-align: center;
        font-weight: 700;
    }

    /* Cột Vận động viên: căn trái, rộng hơn */
    tr.header-row th:nth-child(2),
    tr.data-row td:nth-child(2) {
        text-align: left;
        padding-left: 10px;
        min-width: 140px;
        font-weight: 600;
    }

    /* Các cột số: căn phải cho nhìn gọn */
    tr.header-row th:nth-child(n+3):nth-child(-n+9),
    tr.data-row td:nth-child(n+3):nth-child(-n+9) {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }

    /* Cột Ghi chú (cuối) căn trái */
    tr.header-row th:last-child,
    tr.data-row td:last-child {
        text-align: left;
    }

    /* Ảnh trong bảng */
    .sheet-img {
        max-width: 160px;
        max-height: 160px;
        object-fit: contain;
        display: block;
        margin: auto;
    }

    /* 2 ảnh góc */
    .corner-img {
        width: 120px;
        position: absolute;
        top: 10px;
        object-fit: contain;
    }

    #left-img {
        left: 10px;
    }

    #right-img {
        right: 10px;
    }

    /* Tiêu đề ở giữa */
    #title-bar {
        text-align: center;
        margin-top: 80px; /* chừa chỗ cho 2 logo góc */
        font-size: 26px;
        font-weight: 800;
        letter-spacing: 1px;
        text-transform: uppercase;
        color: #111827;
    }

    #title-bar .pvna {
        color: #dc2626; /* PVNA đỏ */
    }

    /* Box “Lưu ý” cạnh QR */
    .note-text {
        position: absolute;
        top: 18px;
        right: 150px; /* chỉnh để nằm sát QR hơn/xa hơn nếu cần */
        font-size: 14px;
        line-height: 1.2;
        text-align: right;
        color: #f9fafb;
        text-shadow: 0 1px 2px rgba(0,0,0,0.7);
    }

    .note-text .note-title {
        font-weight: 700;
        text-transform: uppercase;
    }

    /* Text “Đang tải…” */
    #table-container {
        text-align: center;
        padding: 8px;
        font-size: 14px;
        color: #6b7280;
    }
</style>

</head>
<body>

<!-- Ảnh trái -->
<img id="left-img" class="corner-img" 
     src="https://raw.githubusercontent.com/tanminhtung/pnva-quang-ninh/refs/heads/main/images/anh%20pvna.jpg" 
     alt="Left Corner">

<!-- Ảnh phải (QR) -->
<img id="right-img" class="corner-img" 
     src="https://raw.githubusercontent.com/tanminhtung/pnva-quang-ninh/refs/heads/main/images/QR%20teck%20ko.jpg" 
     alt="Right Corner">

<!-- Khối chữ Lưu ý cạnh QR -->
<div class="note-text">
    <div class="note-title">Lưu ý:</div>
    <div>Người chơi thua</div>
    <div>20k/vợt/trận</div>
</div>

<!-- Tiêu đề ở giữa -->
<div id="title-bar">
    <span class="pvna">PVNA</span> SOCIAL TEST YOUR SKILL
</div>

<div id="container">
    <div class="sheet-card">
        <div id="table-container">Đang tải...</div>
    </div>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbz1_Pv7nnFw5Ylh-HFE-BxxdQYXX8FIIuesc239s6helZOfI27WwfLMbRvQfDWSk3wrZg/exec";

async function loadTable() {
    const container = document.getElementById("table-container");

    try {
        const res = await fetch(SCRIPT_URL);
        const json = await res.json();
        const data = json.data;

        const table = document.createElement("table");

        let dataRowCounter = 0; // để đánh số hàng dữ liệu cho zebra

        data.forEach((row, rIndex) => {
            const tr = document.createElement("tr");

            // Xác định loại hàng
            if (rIndex === 3) {
                tr.classList.add("header-row");
            } else if (rIndex > 3) {
                dataRowCounter++;
                tr.classList.add("data-row");
                tr.classList.add(dataRowCounter % 2 === 0 ? "data-even" : "data-odd");
            }

            row.forEach((cell, cIndex) => {
                const isHeader = (rIndex === 3);
                const cellEl = document.createElement(isHeader ? "th" : "td");

                // Có ảnh trong sheet
                if (cell.imageUrls && cell.imageUrls.length > 0) {
                    const img = document.createElement("img");
                    img.src = cell.imageUrls[0];
                    img.className = "sheet-img";
                    cellEl.appendChild(img);
                }

                // Có text
                if (cell.text) {
                    cellEl.appendChild(document.createTextNode(cell.text));
                }

                tr.appendChild(cellEl);
            });

            table.appendChild(tr);
        });

        container.innerHTML = "";
        container.appendChild(table);

    } catch (err) {
        console.error(err);
        container.textContent = "Lỗi tải dữ liệu!";
    }
}

loadTable();
</script>

</body>
</html>
