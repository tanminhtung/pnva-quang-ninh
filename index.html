<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Viewer</title>

<style>
    body {
        font-family: Arial, sans-serif;
        padding: 0;
        margin: 0;
        background: #0f172a; /* n·ªÅn ƒë·∫≠m ki·ªÉu s√¢n ƒë·∫•u */
        color: #111827;
    }

    #container {
        padding: 10px;
        max-width: 1200px;
        margin: auto;
    }

    /* Th·∫ª ‚Äúcard‚Äù bao quanh b·∫£ng cho chuy√™n nghi·ªáp */
    .sheet-card {
        background: #ffffff;
        border-radius: 10px;
        box-shadow: 0 12px 30px rgba(15, 23, 42, 0.35);
        padding: 14px 14px 18px;
        margin-top: 16px;
        border: 1px solid #1f2937;
    }

    /* B·ªçc b·∫£ng ƒë·ªÉ c√≥ th·ªÉ k√©o ngang tr√™n m√†n nh·ªè */
    #table-container {
        text-align: center;
        padding: 4px;
        font-size: 15px; /* ch·ªØ trong b·∫£ng to h∆°n m·ªôt ch√∫t */
        color: #6b7280;
        overflow-x: auto;
    }

    #table-container table {
        margin: 0 auto;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        background: white;
        margin-top: 8px;
        min-width: 720px; /* n·∫øu m√†n nh·ªè h∆°n th√¨ xu·∫•t hi·ªán thanh k√©o ngang */
    }

    /* Header b·∫£ng */
    tr.header-row th {
        background: #0b2540;      /* navy */
        color: #ffffff;
        font-weight: 700;
        padding: 8px 8px;
        text-transform: uppercase;
        font-size: 14px;  /* to h∆°n m·ªôt ch√∫t */
        letter-spacing: 0.04em;
        border-bottom: 2px solid #111827;
    }

    /* √î d·ªØ li·ªáu chung */
    td {
        padding: 6px 8px;
        border: none;
        font-size: 15px;      /* tƒÉng t·ª´ 13px ‚Üí 15px */
        font-weight: 500;     /* h∆°i ƒë·∫≠m ƒë·ªÉ d·ªÖ nh√¨n */
        color: #111827;
    }

    /* Zebra cho data-row */
    tr.data-row.data-odd td {
        background: #ffffff;
    }

    tr.data-row.data-even td {
        background: #f3f4f6;
    }

    /* Hover hi·ªáu ·ª©ng b·∫£ng ƒë·∫•u (ch·ªâ h·ªØu √≠ch tr√™n thi·∫øt b·ªã c√≥ chu·ªôt) */
    @media (hover: hover) {
      tr.data-row:hover td {
          background: #e0f2fe;
      }
    }

    /* C·ªôt STT: h·∫πp, n·ªïi b·∫≠t */
    tr.header-row th:nth-child(1),
    tr.data-row td:nth-child(1) {
        width: 40px;
        text-align: center;
        font-weight: 700;
    }

    /* C·ªôt V·∫≠n ƒë·ªông vi√™n: cƒÉn tr√°i, r·ªông h∆°n */
    tr.header-row th:nth-child(2),
    tr.data-row td:nth-child(2) {
        text-align: left;
        padding-left: 10px;
        min-width: 140px;
        font-weight: 700;  /* t√™n VƒêV ƒë·∫≠m h∆°n cho n·ªïi */
    }

    /* C√°c c·ªôt s·ªë: cƒÉn ph·∫£i cho g·ªçn */
    tr.header-row th:nth-child(n+3):nth-child(-n+9),
    tr.data-row td:nth-child(n+3):nth-child(-n+9) {
        text-align: right;
        font-variant-numeric: tabular-nums;
    }

    /* C·ªôt Ghi ch√∫ (cu·ªëi) cƒÉn tr√°i */
    tr.header-row th:last-child,
    tr.data-row td:last-child {
        text-align: left;
    }

    /* ·∫¢nh trong b·∫£ng */
    .sheet-img {
        max-width: 160px;
        max-height: 160px;
        object-fit: contain;
        display: block;
        margin: auto;
    }

    /* 2 ·∫£nh g√≥c */
    .corner-img {
        position: absolute;
        top: 10px;
        object-fit: contain;
    }

    /* ·∫¢nh tr√°i l·ªõn h∆°n (logo PVNA) */
    #left-img {
        left: 10px;
        width: 180px;
    }

    /* ·∫¢nh b√™n ph·∫£i (QR) gi·ªØ nguy√™n k√≠ch th∆∞·ªõc ƒë·ªÉ kh√¥ng chi·∫øm qu√° nhi·ªÅu ch·ªó */
    #right-img {
        right: 10px;
        width: 120px;
    }

    /* --- Responsive ch·ªânh l·∫°i cho m√†n h√¨nh nh·ªè --- */
    @media (max-width: 1024px) {
        #left-img { width: 150px; }
        #right-img { width: 100px; }

        /* tr√™n tablet, gi·ªØ font kh√¥ng b·ªã nh·ªè ƒëi */
        td {
            font-size: 15px;
        }
        tr.header-row th {
            font-size: 14px;
        }
    }

    @media (max-width: 768px) {
        #container {
            padding: 8px;
        }

        .corner-img {
            width: 80px;
            top: 6px;
        }

        #title-bar {
            margin-top: 70px;
            font-size: 20px;
            padding: 6px 10px;
        }

        .sheet-card {
            border-radius: 8px;
            box-shadow: 0 8px 20px rgba(15, 23, 42, 0.3);
            padding: 10px 8px 12px;
        }

        /* Tr∆∞·ªõc ƒë√¢y m√¨nh h·∫° font-size, gi·ªù ƒë·ªÉ v·∫´n d·ªÖ ƒë·ªçc tr√™n mobile */
        td {
            padding: 4px 6px;
            font-size: 14px;
        }

        tr.header-row th {
            padding: 6px 6px;
            font-size: 13px;
        }

        /* Box L∆∞u √Ω kh√¥ng fix c·∫°nh QR n·ªØa, cho xu·ªëng ri√™ng */
        .note-text {
            position: static;
            text-align: center;
            margin-top: 8px;
            color: #e5e7eb;
            text-shadow: none;
        }
    }

    @media (max-width: 480px) {
        #title-bar {
            font-size: 18px;
            letter-spacing: 0.5px;
        }

        .corner-img {
            width: 70px;
        }

        table {
            min-width: 640px;
        }
    }

    /* Ti√™u ƒë·ªÅ ·ªü gi·ªØa */
    #title-bar {
        text-align: center;
        margin-top: 80px; /* ch·ª´a ch·ªó cho 2 logo g√≥c */
        font-size: 26px;
        font-weight: 800;
        letter-spacing: 1px;
        text-transform: uppercase;
        color: #f9fafb;
        text-shadow: 0 2px 4px rgba(0,0,0,0.7);
        padding: 4px 8px;
    }

    #title-bar .pvna {
        color: #dc2626; /* PVNA ƒë·ªè */
    }

    /* Box ‚ÄúL∆∞u √Ω‚Äù c·∫°nh QR - desktop / tablet r·ªông */
    .note-text {
        position: absolute;
        top: 18px;
        right: 150px; /* ch·ªânh s√°t/xa QR n·∫øu c·∫ßn */
        font-size: 14px;
        line-height: 1.2;
        text-align: right;
        color: #f9fafb;
        text-shadow: 0 1px 2px rgba(0,0,0,0.7);
    }

    .note-text .note-title {
        font-weight: 700;
        text-transform: uppercase;
    }
</style>

</head>
<body>

<!-- ·∫¢nh tr√°i -->
<img id="left-img" class="corner-img" 
     src="https://raw.githubusercontent.com/tanminhtung/pnva-quang-ninh/refs/heads/main/images/anh%20pvna.jpg" 
     alt="Left Corner">

<!-- ·∫¢nh ph·∫£i (QR) -->
<img id="right-img" class="corner-img" 
     src="https://raw.githubusercontent.com/tanminhtung/pnva-quang-ninh/refs/heads/main/images/QR%20teck%20ko.jpg" 
     alt="Right Corner">

<!-- Kh·ªëi ch·ªØ L∆∞u √Ω (desktop: c·∫°nh QR, mobile: xu·ªëng d∆∞·ªõi, cƒÉn gi·ªØa) -->
<div class="note-text">
    <div class="note-title">L∆∞u √Ω:</div>
    <div>Ng∆∞·ªùi ch∆°i thua</div>
    <div>20k/v·ª£t/tr·∫≠n</div>
</div>

<!-- Ti√™u ƒë·ªÅ ·ªü gi·ªØa -->
<div id="title-bar">
    <span class="pvna">PVNA</span> SOCIAL TEST YOUR SKILL
</div>

<div id="container">
    <div class="sheet-card">
        <div id="table-container">ƒêang t·∫£i...</div>
    </div>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbz1_Pv7nnFw5Ylh-HFE-BxxdQYXX8FIIuesc239s6helZOfI27WwfLMbRvQfDWSk3wrZg/exec";

async function loadTable() {
    const container = document.getElementById("table-container");

    try {
        const res = await fetch(SCRIPT_URL);
        const json = await res.json();
        const data = json.data;

        const table = document.createElement("table");

        let headerFound = false;
        let dataRowCounter = 0;

        data.forEach((row) => {
            if (!row || row.length === 0) return;

            // L·∫•y text √¥ STT (√¥ ƒë·∫ßu ti√™n)
            const firstCell = row[0];
            const firstText = firstCell && firstCell.text
                ? firstCell.text.toString().trim()
                : "";

            // X√°c ƒë·ªãnh h√†ng header: √¥ ƒë·∫ßu ti√™n c√≥ text "STT" (ch·ªâ l·∫ßn ƒë·∫ßu)
            const isHeaderRow = !headerFound && firstText.toUpperCase() === "STT";

            // H√†ng c√≥ b·∫•t k·ª≥ n·ªôi dung n√†o (text ho·∫∑c h√¨nh)?
            const hasAnyContent = row.some((cell) =>
                cell &&
                (
                    (cell.text && cell.text.toString().trim() !== "") ||
                    (cell.imageUrls && cell.imageUrls.length > 0)
                )
            );

            // üîπ Tr∆∞·ªõc khi g·∫∑p header:
            //   ‚Äì N·∫øu kh√¥ng ph·∫£i header & kh√¥ng c√≥ n·ªôi dung ‚Üí b·ªè qua
            if (!headerFound && !isHeaderRow && !hasAnyContent) {
                return;
            }

            // üîπ Sau khi c√≥ header:
            //   ‚Äì N·∫øu kh√¥ng ph·∫£i header
            //   ‚Äì V√† (kh√¥ng c√≥ n·ªôi dung ho·∫∑c STT r·ªóng) ‚Üí b·ªè qua (ch√≠nh l√† c√°c d√≤ng tr·∫Øng cu·ªëi)
            if (headerFound && !isHeaderRow) {
                const hasSTT = firstText !== "";
                if (!hasAnyContent || !hasSTT) {
                    return;
                }
            }

            const tr = document.createElement("tr");

            if (isHeaderRow) {
                tr.classList.add("header-row");
                headerFound = true;
            } else if (headerFound) {
                dataRowCounter++;
                tr.classList.add("data-row");
                tr.classList.add(dataRowCounter % 2 === 0 ? "data-even" : "data-odd");
            }

            row.forEach((cell) => {
                const cellEl = document.createElement(isHeaderRow ? "th" : "td");

                if (cell && cell.imageUrls && cell.imageUrls.length > 0) {
                    const img = document.createElement("img");
                    img.src = cell.imageUrls[0];
                    img.className = "sheet-img";
                    cellEl.appendChild(img);
                }

                if (cell && cell.text && cell.text.toString().trim() !== "") {
                    cellEl.appendChild(document.createTextNode(cell.text));
                }

                tr.appendChild(cellEl);
            });

            table.appendChild(tr);
        });

        container.innerHTML = "";
        container.appendChild(table);

    } catch (err) {
        console.error(err);
        container.textContent = "L·ªói t·∫£i d·ªØ li·ªáu!";
    }
}

loadTable();
</script>

</body>
</html>
